<script>
'use strict';
window.Capira = window.Capira || {};
Capira.QuizValue = {
    properties: {
        value: {
            observer: '_valueChanged',
            notify: true
        },
    },
    evaluate: function() {
        return this._getCombinationByValue(this.value);
    },
    _getCombinationByValue: function(value) {
        var arr = this.overlay.combinations.slice();
        arr.sort(this.sortFn);
        for (var i = 0; i < arr.length; i++) {
            var v = arr[i].value;
            if (v === undefined || this._valueEquals(v, value)) {
                return arr[i];
            }
        }
        return undefined;
    },
    _valueEquals: function(expected, given) {
        return expected === given;
    },

    sortFn: function(a, b) {
        if (!a || a.value === undefined) {
            return 1;
        }
        if (!b || b.value === undefined) {
            return -1;
        }
        return a.grade - b.grade;
    },

    _valueChanged: function(value) {
        this.fire('answer-changed', value);
    },
};
</script>
