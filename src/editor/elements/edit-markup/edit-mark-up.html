<script>
'use strict';
window.Capira.EditableMarkup = {
    properties: {
        uneditable: {
            value: false
        },
        pointerEvents: {
            value: false
        }
    },
    listeners: {
        'focus': '_edit',
        'blur': '_done'
    },
    _edit: function() {
        Polymer.dom(this).textContent = this.content;
    },
    _done: function() {
        this.set('content', Polymer.dom(this).textContent);
    },
    attached: function() {
        if (!this.uneditable) {
            if (this.pointerEvents) {
                this.style.pointerEvents = 'all';
            }
            this.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            this.addEventListener('keydown', function(e) {
                e.stopPropagation();
            });
            this.addEventListener('keydown', function(e) {
                e.stopPropagation();
            });
            this.addEventListener('keypress', function(e) {
                e.stopPropagation();
                if (e.keyCode === 13) { // enter
                    this.blur();
                    e.preventDefault();
                }
            });
            Polymer.dom(this).setAttribute('contenteditable', true);
            this.style.zIndex = 100;
        }
    }
};
</script>
