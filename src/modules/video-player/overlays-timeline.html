<dom-module id="overlays-timeline">
    <style>
    :host {
        position: absolute;
        left: 12px;
        right: 12px;
        bottom: 35px;
        /*border: 1px solid green;*/
        height: 12px;
        pointer-events:none;
        display: none;
    }
    
    .timeline-overlay-anchor {
        display: none;
        background-color: darkorange;
        transition: opacity 0.1s, background-color 0.1s;
        position: absolute;
        width: 4px;
        height: 100%;
        margin-left: -2px;
        opacity: 0.4;
        border-radius: 2px;
        pointer-events:all;
    }
    
    .timeline-overlay-anchor:hover {
        opacity: 1;
        translate:scale(1.2);
    }
    </style>
    <template>
        <template is="dom-repeat" items="{{overlays}}">
            <div class="timeline-overlay-anchor" style$="{{_anchorStyle(item.events.*,duration)}}" on-click="_jumpToOverlay"></div>
        </template>
    </template>
</dom-module>
<script>
'use strict';
(function() {
    Polymer({
        is: 'overlays-timeline',
        properties: {
            overlays: {
                type: Array
            },
            duration: {
                value: 0
            }
        },
        _anchorStyle: function(overlayEventsChangeRecord, duration) {
            var events = overlayEventsChangeRecord.base;
            if (!events) {
                return 'display:none'; // overlay that isn't triggert by timer
            }
            var styleString = 'display:block; ';
            for (var i = 0; i < events.length; ++i) {
                styleString += 'left:' + (100 * events[i].start / duration) + '%;';
            }
            return styleString;
        },

        _jumpToOverlay: function(event) {
            event.stopPropagation();
            this.fire('overlay-selected', event.model.item);
        },
        show:function(){
            this.style.display='block';
        },
        hide:function(){
             this.style.display='none';
        }
    });
})();
</script>
