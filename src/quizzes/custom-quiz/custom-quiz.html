<link rel="import" href="../base/quiz.html">
<link rel="import" href="../../base/overlays/behaviors/has-items.html">
<link rel="import" href="../base/question-card/question-feedback-card.html">
<link rel="import" href="../base/behaviors/slang.html">
<link rel="import" href="../../plugins/math/mathslang/math-input/math-input-explanation.html">
<dom-module id="custom-quiz">
    <template>
        <style>
        #card {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            height: 64px;
        }
        
        math-input-explanation-button {
            position: absolute;
            top: 16px;
            right: 64px;
            background-color: rgba(0, 0, 0, 0.1);
            color: white;
        }
        </style>
        <div id="content">
        <content></content>
        </div>
        <question-feedback-card id="card" is-top question="{{overlay.question}}" combination="{{combination}}" animate-wrong></question-feedback-card>
        <math-input-explanation-button></math-input-explanation-button>
    </template>
</dom-module>
<script>
'use strict';
(function() {
    Polymer({
        is: 'custom-quiz',
        behaviors: Capira.selectBehaviors({
            core: [Capira.Quiz, Capira.HasItems, Capira.Slang],
            editor: Capira.HasEditableItems
        }),
        listeners: {
            'item-value-changed': '_itemValueChanged'
        },
        _itemValueChanged: function(event) {
            if (event && event.detail) {
                var target = event.detail;
                this.value = this.value || {};
                this.value[target.id] = target.value;
                this._valueChanged(this.value);
            }
        },
        _valueEquals: function(expected, given) {
            if (typeof expected === 'string') {
                return this.mathslang.compare(expected, given);
            } else {
                return this.mathslang.compare(expected, given);
            }
        }
    });
})();
</script>
